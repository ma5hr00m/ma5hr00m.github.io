<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="æš‘æœŸçš„å°¾å£°æ¸è¿‘ï¼Œåˆ›æ–°å®è·µè¯¾çš„è€å¸ˆçªç„¶è¦éªŒæ”¶æš‘æœŸå­¦ä¹ æˆæœï¼Œæ„šè ¢çš„é˜¿è‡å¯¹æ­¤äº‹å®Œå…¨æ²¡æœ‰å°è±¡â€¦â€¦æ¯«æ— å‡†å¤‡çš„ä»–å†³å®šä¸´æ—¶æ“ä¸ªå°ä¸œè¥¿å‡ºæ¥ã€‚å‰ç«¯è‚¯å®šæ˜¯è¦ç”¨ React æ¥åšï¼Œåç«¯å˜›â€¦â€¦æ€æ¥æƒ³å»ï¼Œå‡†å¤‡å­¦ä¹  koa ç°å­¦ç°å–ä¸€ä¸‹ã€‚ä¹‹å‰æ²¡ç”¨ node.js å†™è¿‡åç«¯ï¼Œæƒ³å°è¯•å°è¯•æ–°ä¸œè¥¿ï¼Œå•çº¯ä¸ºäº†è¡¥ä½œä¸šè€Œå†™ä¸œè¥¿æ„Ÿè§‰ä¸å€¼â€¦â€¦ å‡†å¤‡å…ˆäº†è§£ä¸€äº›åŸºæœ¬æ¦‚å¿µã€‚ koakoa æ˜¯ä¸€ä¸ªåŸºäº Node.js çš„ Web å¼€å‘æ¡†æ¶ï¼Œæä¾›äº†ä¸€ç§">
<meta property="og:type" content="article">
<meta property="og:title" content="åŸºäº Koa2+SQLite æ„å»º CRUD API">
<meta property="og:url" content="https://blog.ma5hr00m.top/2023/04/28/202304/koa2-crud-example/index.html">
<meta property="og:site_name" content="è‡ç‰©è¯­">
<meta property="og:description" content="æš‘æœŸçš„å°¾å£°æ¸è¿‘ï¼Œåˆ›æ–°å®è·µè¯¾çš„è€å¸ˆçªç„¶è¦éªŒæ”¶æš‘æœŸå­¦ä¹ æˆæœï¼Œæ„šè ¢çš„é˜¿è‡å¯¹æ­¤äº‹å®Œå…¨æ²¡æœ‰å°è±¡â€¦â€¦æ¯«æ— å‡†å¤‡çš„ä»–å†³å®šä¸´æ—¶æ“ä¸ªå°ä¸œè¥¿å‡ºæ¥ã€‚å‰ç«¯è‚¯å®šæ˜¯è¦ç”¨ React æ¥åšï¼Œåç«¯å˜›â€¦â€¦æ€æ¥æƒ³å»ï¼Œå‡†å¤‡å­¦ä¹  koa ç°å­¦ç°å–ä¸€ä¸‹ã€‚ä¹‹å‰æ²¡ç”¨ node.js å†™è¿‡åç«¯ï¼Œæƒ³å°è¯•å°è¯•æ–°ä¸œè¥¿ï¼Œå•çº¯ä¸ºäº†è¡¥ä½œä¸šè€Œå†™ä¸œè¥¿æ„Ÿè§‰ä¸å€¼â€¦â€¦ å‡†å¤‡å…ˆäº†è§£ä¸€äº›åŸºæœ¬æ¦‚å¿µã€‚ koakoa æ˜¯ä¸€ä¸ªåŸºäº Node.js çš„ Web å¼€å‘æ¡†æ¶ï¼Œæä¾›äº†ä¸€ç§">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://agu-images.oss-cn-hangzhou.aliyuncs.com/test/image-20230828212321994.png">
<meta property="og:image" content="https://agu-images.oss-cn-hangzhou.aliyuncs.com/test/image-20230828220513695.png">
<meta property="og:image" content="https://agu-images.oss-cn-hangzhou.aliyuncs.com/test/image-20230829135418397.png">
<meta property="og:image" content="https://agu-images.oss-cn-hangzhou.aliyuncs.com/test/image-20230829141158347.png">
<meta property="article:published_time" content="2023-04-27T16:00:00.000Z">
<meta property="article:modified_time" content="2024-06-09T12:56:25.626Z">
<meta property="article:author" content="ma5hr00m">
<meta property="article:tag" content="ma5hr00m, blog, é˜¿è‡, æŠ€æœ¯, ä¸ªäººåšå®¢">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://agu-images.oss-cn-hangzhou.aliyuncs.com/test/image-20230828212321994.png">
    
    
      
        
          <link rel="shortcut icon" href="https://img.ma5hr00m.top/blog/im-favicon.svg">
        
      
      
        
          <link rel="icon" type="image/png" href="https://img.ma5hr00m.top/blog/im-favicon.svg" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="https://img.ma5hr00m.top/blog/im-favicon.svg">
        
      
    
    <!-- title -->
    <title>åŸºäº Koa2+SQLite æ„å»º CRUD API</title>
    <!-- async scripts -->
    <!-- Google Analytics -->

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-JYGWHCT9EX"></script>
  <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-JYGWHCT9EX');
  </script>


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<meta name="generator" content="Hexo 7.2.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="ç›®å½•"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="ç›®å½•"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="é¡¶éƒ¨" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">é¦–é¡µ</a></li><!--
     --><!--
       --><li><a href="/about/">å…³äº</a></li><!--
     --><!--
       --><li><a href="/archives/">å½’æ¡£</a></li><!--
     --><!--
       --><li><a href="/friends/">å‹é“¾</a></li><!--
     --><!--
       --><li><a href="/categories/">åˆ†ç±»</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/ma5hr00m">é¡¹ç›®</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="ä¸Šä¸€ç¯‡" href="/2023/05/02/202305/docker-base/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="ä¸‹ä¸€ç¯‡" href="/2023/01/26/202301/unocss-theme/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="è¿”å›é¡¶éƒ¨" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="åˆ†äº«æ–‡ç« " href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">ä¸Šä¸€ç¯‡</span>
      <span id="i-next" class="info" style="display:none;">ä¸‹ä¸€ç¯‡</span>
      <span id="i-top" class="info" style="display:none;">è¿”å›é¡¶éƒ¨</span>
      <span id="i-share" class="info" style="display:none;">åˆ†äº«æ–‡ç« </span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://blog.ma5hr00m.top/2023/04/28/202304/koa2-crud-example/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://blog.ma5hr00m.top/2023/04/28/202304/koa2-crud-example/&text=åŸºäº Koa2+SQLite æ„å»º CRUD API"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://blog.ma5hr00m.top/2023/04/28/202304/koa2-crud-example/&title=åŸºäº Koa2+SQLite æ„å»º CRUD API"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://blog.ma5hr00m.top/2023/04/28/202304/koa2-crud-example/&is_video=false&description=åŸºäº Koa2+SQLite æ„å»º CRUD API"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=åŸºäº Koa2+SQLite æ„å»º CRUD API&body=Check out this article: https://blog.ma5hr00m.top/2023/04/28/202304/koa2-crud-example/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://blog.ma5hr00m.top/2023/04/28/202304/koa2-crud-example/&title=åŸºäº Koa2+SQLite æ„å»º CRUD API"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://blog.ma5hr00m.top/2023/04/28/202304/koa2-crud-example/&title=åŸºäº Koa2+SQLite æ„å»º CRUD API"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://blog.ma5hr00m.top/2023/04/28/202304/koa2-crud-example/&title=åŸºäº Koa2+SQLite æ„å»º CRUD API"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://blog.ma5hr00m.top/2023/04/28/202304/koa2-crud-example/&title=åŸºäº Koa2+SQLite æ„å»º CRUD API"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://blog.ma5hr00m.top/2023/04/28/202304/koa2-crud-example/&name=åŸºäº Koa2+SQLite æ„å»º CRUD API&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://blog.ma5hr00m.top/2023/04/28/202304/koa2-crud-example/&t=åŸºäº Koa2+SQLite æ„å»º CRUD API"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%86%E5%A4%87"><span class="toc-number">1.</span> <span class="toc-text">å‡†å¤‡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#koa"><span class="toc-number">1.1.</span> <span class="toc-text">koa</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sqlite"><span class="toc-number">1.2.</span> <span class="toc-text">sqlite</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F"><span class="toc-number">2.</span> <span class="toc-text">æ¨¡å¼</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E6%88%98%E5%9C%BA%E6%99%AF%E6%A6%82%E6%8B%AC"><span class="toc-number">3.</span> <span class="toc-text">å®æˆ˜åœºæ™¯æ¦‚æ‹¬</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E9%A1%B9%E7%9B%AE"><span class="toc-number">4.</span> <span class="toc-text">åˆå§‹åŒ–é¡¹ç›®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#init-ping"><span class="toc-number">5.</span> <span class="toc-text">init &amp; ping</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#database"><span class="toc-number">6.</span> <span class="toc-text">database</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#schema"><span class="toc-number">7.</span> <span class="toc-text">schema</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#modules"><span class="toc-number">8.</span> <span class="toc-text">modules</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#controllers"><span class="toc-number">9.</span> <span class="toc-text">controllers</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#router-api"><span class="toc-number">10.</span> <span class="toc-text">router&#x2F;api</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bodyparser-cors"><span class="toc-number">11.</span> <span class="toc-text">bodyparser &amp; cors</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E8%A7%A3%E6%9E%90"><span class="toc-number">11.1.</span> <span class="toc-text">å‚æ•°è§£æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%A8%E5%9F%9F"><span class="toc-number">11.2.</span> <span class="toc-text">è·¨åŸŸ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#app"><span class="toc-number">12.</span> <span class="toc-text">app</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7"><span class="toc-number">13.</span> <span class="toc-text">æµ‹è¯•å·¥å…·</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%98%E5%8C%96"><span class="toc-number">14.</span> <span class="toc-text">ä¼˜åŒ–</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">15.</span> <span class="toc-text">å‚è€ƒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%8E%E8%AF%9D"><span class="toc-number">16.</span> <span class="toc-text">åè¯</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        åŸºäº Koa2+SQLite æ„å»º CRUD API
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">ma5hr00m</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2023-04-27T16:00:00.000Z" class="dt-published" itemprop="datePublished">2023-04-28</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/Node-js/">Node.js</a>
    </div>


      

    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p>æš‘æœŸçš„å°¾å£°æ¸è¿‘ï¼Œåˆ›æ–°å®è·µè¯¾çš„è€å¸ˆçªç„¶è¦éªŒæ”¶æš‘æœŸå­¦ä¹ æˆæœï¼Œæ„šè ¢çš„é˜¿è‡å¯¹æ­¤äº‹å®Œå…¨æ²¡æœ‰å°è±¡â€¦â€¦æ¯«æ— å‡†å¤‡çš„ä»–å†³å®šä¸´æ—¶æ“ä¸ªå°ä¸œè¥¿å‡ºæ¥ã€‚å‰ç«¯è‚¯å®šæ˜¯è¦ç”¨ React æ¥åšï¼Œåç«¯å˜›â€¦â€¦æ€æ¥æƒ³å»ï¼Œå‡†å¤‡å­¦ä¹  koa ç°å­¦ç°å–ä¸€ä¸‹ã€‚ä¹‹å‰æ²¡ç”¨ node.js å†™è¿‡åç«¯ï¼Œæƒ³å°è¯•å°è¯•æ–°ä¸œè¥¿ï¼Œå•çº¯ä¸ºäº†è¡¥ä½œä¸šè€Œå†™ä¸œè¥¿æ„Ÿè§‰ä¸å€¼â€¦â€¦</p>
<h2 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h2><p>å…ˆäº†è§£ä¸€äº›åŸºæœ¬æ¦‚å¿µã€‚</p>
<h3 id="koa"><a href="#koa" class="headerlink" title="koa"></a>koa</h3><p><code>koa</code> æ˜¯ä¸€ä¸ªåŸºäº Node.js çš„ Web å¼€å‘æ¡†æ¶ï¼Œæä¾›äº†ä¸€ç§<strong>ç®€æ´ä¼˜é›…</strong>çš„æ–¹å¼æ¥å¤„ç† HTTP è¯·æ±‚å’Œå“åº”ã€‚æˆ‘ä¸ªäººè§‰å¾— koa å°±æ˜¯ç²¾ç®€ç‰ˆçš„ Expressï¼Œåˆ å‡äº†è·¯ç”±ã€è§†å›¾æ¸²æŸ“ç­‰å¤šç§åŠŸèƒ½ï¼ŒåŒæ—¶åœ¨ä¸­é—´ä»¶ä»¥åŠå¼‚æ­¥å¤„ç†ç­‰æ–¹é¢è¿›è¡Œäº†ä¸€äº›ä¼˜åŒ–ã€‚</p>
<p>å¯ä»¥å» <a target="_blank" rel="noopener" href="https://www.koajs.com.cn/">ğŸ‘‹koa å®˜ç½‘</a> è¿›ä¸€æ­¥äº†è§£ã€‚ä½†å®˜ç½‘é˜…è¯»èµ·æ¥æ¯”è¾ƒéš¾å—ï¼Œç›®å½•ä¸æ˜¯å¾ˆå¥½ï¼Œä½†ä¸€æ‰‹æ–‡æ¡£çš„å‚è€ƒç®€ç›´è‡ªç„¶æ˜¯æ²¡å¾—è¯´ã€‚</p>
<p>å¦‚æœåªæƒ³è¦å¿«é€Ÿä¸Šæ‰‹ koa å¼€å‘ï¼Œé˜¿è‡æ›´æ¨èä¸‹é¢è¿™ä¸ªæ•™ç¨‹ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://chenshenhai.github.io/koa2-note/">ã€ŠKoa3 è¿›é˜¶å­¦ä¹ ç¬”è®°ã€‹</a></p>
<h3 id="sqlite"><a href="#sqlite" class="headerlink" title="sqlite"></a>sqlite</h3><p><code>sqlite</code> æ˜¯ä¸€ä¸ªåµŒå…¥å¼ SQL æ•°æ®åº“å¼•æ“ï¼Œå®ƒæä¾›äº†ä¸€ç§ç®€å•ã€è½»é‡çº§ä¸”ç‹¬ç«‹çš„æ–¹æ³•æ¥å­˜å‚¨å’Œç®¡ç†æ•°æ®ã€‚å®ƒä¸éœ€è¦å•ç‹¬çš„æœåŠ¡å™¨è¿›ç¨‹ï¼Œå¯ä»¥ç›´æ¥åœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ã€‚å®ƒä¸åƒ MySQL é‚£ä¹ˆç¬¨é‡ï¼Œè½»ä¾¿åˆ°ä½ åªéœ€è¦åœ¨ä½ çš„é¡¹ç›®ä¸­ç•™æœ‰ä¸€ä¸ª sqlite.db å³å¯ï¼Œå¯¹åˆå­¦è€…æ¥è¯´çœå»äº†å¾ˆå¤šé…ç½®ç¯å¢ƒçš„éº»çƒ¦ï¼ˆé˜¿è‡é¦–æ¬¡æ¥è§¦åˆ°çš„æ•°æ®åº“å°±æ˜¯ sqliteï¼‰ã€‚</p>
<h2 id="æ¨¡å¼"><a href="#æ¨¡å¼" class="headerlink" title="æ¨¡å¼"></a>æ¨¡å¼</h2><p><code>MVC</code> æ˜¯ä¸€ä¸ªæœ€åŸºæœ¬çš„æ ¸å¿ƒæ¶æ„çŸ¥è¯†ï¼Œä»¥åä¼šç»å¸¸ç”¨åˆ°ã€‚ä½ æ˜¯ç¦»ä¸å¼€å®ƒçš„ğŸ¤—ã€‚</p>
<p><img src="https://agu-images.oss-cn-hangzhou.aliyuncs.com/test/image-20230828212321994.png" alt="MVCæ¶æ„å›¾"></p>
<p>MVC æ¨¡å¼ï¼Œå…¨ç§°ä¸º Model-View-Controllerï¼ˆæ¨¡å‹-è§†å›¾-æ§åˆ¶å™¨ï¼‰æ¨¡å¼ï¼Œå®ƒæ˜¯ä¸€ç§è½¯ä»¶æ¶æ„æ¨¡å¼ï¼Œå…¶ç›®æ ‡æ˜¯å°†è½¯ä»¶çš„ç”¨æˆ·ç•Œé¢ï¼ˆå³å‰å°é¡µé¢ï¼‰å’Œä¸šåŠ¡é€»è¾‘åˆ†ç¦»ï¼Œä½¿ä»£ç å…·æœ‰æ›´é«˜çš„å¯æ‰©å±•æ€§ã€å¯å¤ç”¨æ€§ã€å¯ç»´æŠ¤æ€§ä»¥åŠçµæ´»æ€§ã€‚</p>
<p>å…·ä½“åˆ°ä»£ç å±‚é¢ï¼ŒMVC å°†åº”ç”¨ç¨‹åºåˆ†ä¸ºä¸‰ä¸ªä¸»è¦éƒ¨åˆ†ï¼šæ¨¡å‹ï¼ˆModelï¼‰ã€è§†å›¾ï¼ˆViewï¼‰å’Œæ§åˆ¶å™¨ï¼ˆControllerï¼‰ã€‚Model è´Ÿè´£æ•°æ®çš„å­˜å‚¨å’Œå¤„ç†ï¼ŒController è´Ÿè´£ä¸šåŠ¡é€»è¾‘çš„å¤„ç†å’Œåè°ƒï¼ŒView è´Ÿè´£æ•°æ®çš„å¯è§†åŒ–å‘ˆç°ç»™ç”¨æˆ·ã€‚</p>
<p>MVC æ¨¡å¼çš„ä¼˜åŠ¿åœ¨äºåˆ†ç¦»å…³æ³¨ç‚¹ã€æé«˜ä»£ç çš„å¯é‡ç”¨æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚é€šè¿‡å°†åº”ç”¨ç¨‹åºåˆ†æˆæ¨¡å‹ã€è§†å›¾å’Œæ§åˆ¶å™¨ï¼Œå®ç°æ›´å¥½åœ°ç»„ç»‡ä»£ç ã€é™ä½æ¨¡å—ä¹‹é—´çš„è€¦åˆåº¦ï¼Œå¹¶æä¾›äº†è‰¯å¥½çš„æ‰©å±•æ€§å’Œå¯æµ‹è¯•æ€§ã€‚</p>
<p>é™¤äº† MVCï¼Œè¿˜æœ‰å…¶ä»–ä¸€äº›å¸¸è§çš„æ¶æ„æ¨¡å¼ï¼Œè¿™é‡Œä¸åšå±•å¼€ä»‹ç»ğŸ˜œï¼Œæ„Ÿå…´è¶£çš„è¯·è‡ªè¡Œå‰å¾€ä»¥ä¸‹é“¾æ¥äº†è§£ï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/Model-view-presenter">MVPæ¨¡å¼ï¼ˆModel-View-Presenterï¼‰</a></li>
<li><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93viewmodel">MVVMæ¨¡å¼ï¼ˆModel-View-ViewModelï¼‰</a></li>
</ul>
<h2 id="å®æˆ˜åœºæ™¯æ¦‚æ‹¬"><a href="#å®æˆ˜åœºæ™¯æ¦‚æ‹¬" class="headerlink" title="å®æˆ˜åœºæ™¯æ¦‚æ‹¬"></a>å®æˆ˜åœºæ™¯æ¦‚æ‹¬</h2><p>åœ¨æ¥ä¸‹æ¥çš„å®æˆ˜ä¸­ï¼Œæˆ‘ä»¬ä¼šå®ç°ä¸€ä¸ª <code>users</code> è¡¨ï¼ŒåŒ…æ‹¬ idã€username å’Œ password ä¸‰ä¸ªåˆ—ï¼Œå¹¶åŸºäºè¿™ä¸ªè¡¨ä½¿ç”¨ koa ä»¥åŠç›¸å…³åº“å®ç° crud api æ¥å£ï¼Œå¹¶åœ¨å®Œæˆåä½¿ç”¨ <code>postman</code> å·¥å…·è¿›è¡Œæµ‹è¯•ã€‚</p>
<p>ä¸æƒ³å¬æˆ‘å•°å—¦çš„å¯ä»¥ç›´æ¥å»çœ‹ GitHub é¡¹ç›®åœ°å€ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://github.com/ma5hr00m/koa2-crud-example">koa2-crud-example</a></p>
<h2 id="åˆå§‹åŒ–é¡¹ç›®"><a href="#åˆå§‹åŒ–é¡¹ç›®" class="headerlink" title="åˆå§‹åŒ–é¡¹ç›®"></a>åˆå§‹åŒ–é¡¹ç›®</h2><p>å¸¸ç”¨çš„ koa è¯­æ³•å‰å¾€å®˜ç½‘è‡ªè¡Œäº†è§£ ğŸ‘‰<a target="_blank" rel="noopener" href="https://www.koajs.com.cn/#application">Koa ä¸­æ–‡ç½‘</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆå§‹åŒ– node.js é¡¹ç›®</span></span><br><span class="line"><span class="built_in">mkdir</span> example</span><br><span class="line"><span class="built_in">cd</span> example</span><br><span class="line">yarn init</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£… koa</span></span><br><span class="line">yarn add -D koa</span><br></pre></td></tr></table></figure>

<h2 id="init-ping"><a href="#init-ping" class="headerlink" title="init &amp; ping"></a>init &amp; ping</h2><p>è¯¥éƒ¨åˆ†å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://www.liaoxuefeng.com/wiki/1022910821149312/1023025933764960">å¤„ç† URL - å»–é›ªå³°çš„å®˜æ–¹ç½‘ç«™</a>ã€‚è¿™ä¸ªæ–‡ç« ä¼šå‘Šè¯‰ä½ å¦‚ä½•æ­å»ºä¸€ä¸ªåŸºç¡€çš„ koa æœåŠ¡ï¼Œå¹¶ç¼–å†™ä¸€ä¸ª <code>/ping</code> api è¿›è¡Œç¤ºèŒƒã€‚</p>
<p>ä½ éœ€è¦å…ˆå®‰è£…ä¸€äº›ä¾èµ–åº“ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add -D koa-router require-directory</span><br></pre></td></tr></table></figure>

<p><code>koa-router</code> æ˜¯ä¸€ä¸ªç”¨äº koa æ¡†æ¶çš„è·¯ç”±ä¸­é—´ä»¶ï¼Œå®ƒæä¾›äº†ç±»ä¼¼äº Express çš„è·¯ç”±åŠŸèƒ½ï¼ˆä¾‹å¦‚ app.getã€app.putã€app.post ç­‰ï¼‰ã€‚å®ƒæ”¯æŒå‘½å URL å‚æ•°ã€å‘½åè·¯ç”±ä¸ URL ç”Ÿæˆã€åŒ¹é…ç‰¹å®šä¸»æœºçš„è·¯ç”±ã€å“åº”å¸¦æœ‰å…è®¸æ–¹æ³•çš„ OPTIONS è¯·æ±‚ã€æ”¯æŒ 405 æ–¹æ³•ä¸å…è®¸å’Œ 501 æœªå®ç°ç­‰ç‰¹æ€§ã€‚</p>
<p><code>require-directory</code> å¯ä»¥é€’å½’åœ°éå†æŒ‡å®šç›®å½•ï¼Œä½¿ç”¨ <code>require()</code> åŠ è½½æ¯ä¸ªæ–‡ä»¶ï¼Œå¹¶è¿”å›åŒ…å«è¿™äº›æ¨¡å—çš„åµŒå¥—å“ˆå¸Œç»“æ„ã€‚å®ƒå¯ä»¥ç”¨æ¥è‡ªåŠ¨åŠ è½½ç›®å½•ä¸­çš„æ‰€æœ‰æ¨¡å—ï¼Œè€Œä¸éœ€è¦æ‰‹åŠ¨ä¸€ä¸ªä¸€ä¸ªåœ°åŠ è½½ï¼ˆä¼¼ä¹åªé€‚é… Common JSï¼‰ã€‚</p>
<p>å®Œæˆä»¥ä¸‹ä»£ç ï¼Œä½ èƒ½å®ç°ä¸€ä¸ªæœ€åŸºæœ¬çš„ koa åç«¯æœåŠ¡ï¼Œå½“ä½ è®¿é—® <a target="_blank" rel="noopener" href="http://localhost:3000/ping">http://localhost:3000/ping</a> æ—¶èƒ½å¾—åˆ°ä¸€ä¸ª <code>pong!</code> å“åº”ã€‚</p>
<p>å…ˆæ¥çœ‹çœ‹ç›®å½•ç»“æ„ï¼š</p>
<div align='center'>
    <img style='height:200px' src='https://agu-images.oss-cn-hangzhou.aliyuncs.com/test/image-20230828220513695.png' />
</div>

<p><code>/core/init.js</code> æ–‡ä»¶ç”¨äºåˆå§‹åŒ– &#x2F;api&#x2F; ç›®å½•ä¸‹æ‰€æœ‰ api æ¥å£æ–‡ä»¶ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> requireDirectory = <span class="built_in">require</span>(<span class="string">&#x27;require-directory&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Router</span> = <span class="built_in">require</span>(<span class="string">&#x27;koa-router&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">InitManager</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="title function_">initCore</span>(<span class="params">app</span>) &#123;</span><br><span class="line">        <span class="title class_">InitManager</span>.<span class="property">app</span> = app;</span><br><span class="line">        <span class="title class_">InitManager</span>.<span class="title function_">initLoadRouters</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="title function_">initLoadRouters</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">whenLoadModule</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (obj <span class="keyword">instanceof</span> <span class="title class_">Router</span>) &#123;</span><br><span class="line">                <span class="title class_">InitManager</span>.<span class="property">app</span>.<span class="title function_">use</span>(obj.<span class="title function_">routes</span>())</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> apiDirectory = <span class="string">`<span class="subst">$&#123;process.cwd()&#125;</span>/api`</span></span><br><span class="line">        </span><br><span class="line">        requireDirectory(<span class="variable language_">module</span>, apiDirectory, &#123;</span><br><span class="line">            <span class="attr">visit</span>: whenLoadModule</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title class_">InitManager</span>;</span><br></pre></td></tr></table></figure>

<p><code>/api/ping.js</code> å®ç°äº†ä¸€ä¸ªç®€å•çš„åç«¯ api æ¥å£ï¼Œå½“ç”¨æˆ·è®¿é—® &#x2F;ping è·¯ç”±æ—¶ï¼Œåç«¯æœåŠ¡ä¼šè¿”å›ç»™ç”¨æˆ·ä¸€ä¸ª <code>pong!</code> æ–‡æœ¬å“åº”ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Router</span> = <span class="built_in">require</span>(<span class="string">&#x27;koa-router&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> <span class="title class_">Router</span>();</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/ping&#x27;</span>,<span class="keyword">async</span> ctx =&gt; &#123;</span><br><span class="line">    ctx.<span class="property">body</span> = <span class="string">&#x27;pong!&#x27;</span>;</span><br><span class="line">&#125; );</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br></pre></td></tr></table></figure>

<p><code>/app.js</code> æ˜¯å…¥å£æ–‡ä»¶ï¼Œåˆå§‹åŒ–ä¸€ä¸ª Koa å¯¹è±¡ï¼Œè°ƒç”¨ <code>init.js</code> å¯ç”¨æ‰€æœ‰ api æ¥å£ï¼Œç„¶åç›‘å¬æœ¬åœ° 3000 ç«¯å£ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Koa</span> = <span class="built_in">require</span>(<span class="string">&#x27;koa&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">InitManager</span> = <span class="built_in">require</span>(<span class="string">&#x27;./core/init&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> <span class="title class_">Koa</span>();</span><br><span class="line"></span><br><span class="line"><span class="title class_">InitManager</span>.<span class="title function_">initCore</span>(app);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3000</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`ğŸ Listening on localhost:3000 ...`</span>);</span><br></pre></td></tr></table></figure>

<p>å®Œæˆä»¥ä¸Šä»£ç åï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œä»¥ä¸‹æŒ‡ä»¤å¯åŠ¨æœåŠ¡ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node app.js</span><br></pre></td></tr></table></figure>

<h2 id="database"><a href="#database" class="headerlink" title="database"></a>database</h2><p>å…ˆå®‰è£…ä¸€äº›ä¾èµ–åº“ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add -D sqlite3 sequelize</span><br></pre></td></tr></table></figure>

<p><code>sequelize</code> æ˜¯ä¸€ä¸ªåŸºäº promise çš„ Node.js ORMï¼ˆå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰ï¼Œå¯ç”¨äº PostgresSQLã€MySQLã€MariaDBã€SQLite å’Œ Microsoft SQL Server æ•°æ®åº“ã€‚å®ƒæä¾›äº†ä¸€ç§ç®€å•ã€çµæ´»ä¸”å¼ºå¤§çš„æ–¹æ³•æ¥å®šä¹‰æ¨¡å‹å’Œå…³ç³»ï¼Œå¹¶æ”¯æŒäº‹åŠ¡ã€è¿ç§»å’Œå¤æ‚æŸ¥è¯¢ç­‰é«˜çº§åŠŸèƒ½ã€‚</p>
<p>ç®€å•çš„è¯´ï¼Œå°±æ˜¯å¤§å®¶éƒ½ä¸æƒ³å†™ Raw SQLï¼Œè§‰å¾—éº»çƒ¦ä¸”å­˜åœ¨å®‰å…¨é—®é¢˜ï¼Œå°±å°è£…äº†ä¸€å¥—æ¥å£ç”¨æ¥å®ç°å¸¸ç”¨çš„ SQL è¯­å¥ã€‚</p>
<p>æˆ‘ä»¬åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª <code>/database/db.js</code>ï¼Œå†™å…¥ä»¥ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½ ä¸éœ€è¦æ‰‹åŠ¨åˆ›å»º database.dbï¼Œè‹¥ä»£ç æ£€æµ‹åˆ°å¯¹åº”æ•°æ®åº“ä¸å­˜åœ¨åˆ™ä¼šè‡ªåŠ¨åˆ›å»º</span></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Sequelize</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;sequelize&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> sequelize = <span class="keyword">new</span> <span class="title class_">Sequelize</span>(&#123;</span><br><span class="line">    <span class="attr">dialect</span>: <span class="string">&#x27;sqlite&#x27;</span>,</span><br><span class="line">    <span class="attr">storage</span>: <span class="string">&#x27;./sqlite.db&#x27;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    sequelize.<span class="title function_">authenticate</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Connect to database successfully`</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Connection failed: <span class="subst">$&#123;err&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123; sequelize &#125;;</span><br></pre></td></tr></table></figure>

<h2 id="schema"><a href="#schema" class="headerlink" title="schema"></a>schema</h2><p>æˆ‘ä»¬åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª <code>/schema/user.js</code>ï¼Œè¯¥æ–‡ä»¶çš„ä½œç”¨æ˜¯å®šä¹‰äº†æ•°æ®åº“æ¨¡å‹ï¼Œæ–¹ä¾¿æˆ‘ä»¬åœ¨å…¶ä»–æ–‡ä»¶ä½¿ç”¨ã€‚å†™å…¥ä»¥ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">DataTypes</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;sequelize&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">function</span>(<span class="params">sequelize</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> sequelize.<span class="title function_">define</span>(<span class="string">&#x27;user&#x27;</span>, &#123;</span><br><span class="line">        <span class="attr">id</span>: &#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="title class_">DataTypes</span>.<span class="property">INTEGER</span>,</span><br><span class="line">            <span class="attr">primaryKey</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">autoIncrement</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">allowNull</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">field</span>: <span class="string">&#x27;id&#x27;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">username</span>: &#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="title class_">DataTypes</span>.<span class="property">TEXT</span>,</span><br><span class="line">            <span class="attr">allowNull</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">field</span>: <span class="string">&#x27;username&#x27;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">password</span>: &#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="title class_">DataTypes</span>.<span class="property">TEXT</span>,</span><br><span class="line">            <span class="attr">allowNull</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">field</span>: <span class="string">&#x27;password&#x27;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="modules"><a href="#modules" class="headerlink" title="modules"></a>modules</h2><p>è¿™æ®µä»£ç å®šä¹‰äº†ä¸€ä¸ªåä¸º <code>userModel</code> çš„ç±»ï¼Œå®ƒåŒ…å«äº†ä¸€äº›é™æ€æ–¹æ³•ï¼Œç”¨äºå¯¹æ•°æ®åº“ä¸­çš„ <code>users</code> è¡¨è¿›è¡Œæ“ä½œã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> db = <span class="built_in">require</span>(<span class="string">&#x27;../database/db&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> sequelize = db.<span class="property">sequelize</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> user = <span class="built_in">require</span>(<span class="string">&#x27;../schema/user&#x27;</span>)(sequelize);</span><br><span class="line">user.<span class="title function_">sync</span>(&#123;<span class="attr">force</span>: <span class="literal">false</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">userModel</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">async</span> <span class="title function_">showAllUsers</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> users = <span class="keyword">await</span> user.<span class="title function_">findAll</span>();</span><br><span class="line">        <span class="keyword">return</span> users;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">async</span> <span class="title function_">createUser</span>(<span class="params">username, password</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> newUser = <span class="keyword">await</span> user.<span class="title function_">create</span>(&#123;</span><br><span class="line">            username,</span><br><span class="line">            password</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> newUser;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">async</span> <span class="title function_">deleteUser</span>(<span class="params">username</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> result = <span class="keyword">await</span> user.<span class="title function_">destroy</span>(&#123;</span><br><span class="line">            <span class="attr">where</span>: &#123;</span><br><span class="line">                username</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">async</span> <span class="title function_">searchUser</span>(<span class="params">username</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> result = <span class="keyword">await</span> user.<span class="title function_">findOne</span>(&#123;</span><br><span class="line">            <span class="attr">where</span>: &#123;</span><br><span class="line">                username</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">async</span> <span class="title function_">updateUser</span>(<span class="params">userId, username, password</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> result = <span class="keyword">await</span> user.<span class="title function_">update</span>(&#123;</span><br><span class="line">            username,</span><br><span class="line">            password,</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">            <span class="attr">where</span>: &#123;</span><br><span class="line">                <span class="attr">id</span>: userId</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = userModel;</span><br></pre></td></tr></table></figure>

<h2 id="controllers"><a href="#controllers" class="headerlink" title="controllers"></a>controllers</h2><p>è¿™æ®µä»£ç å®šä¹‰äº†ä¸€ä¸ªåä¸º <code>userController</code> çš„ç±»ï¼Œå®ƒåŒ…å«äº†ä¸€äº›é™æ€æ–¹æ³•ï¼Œç”¨äºå¤„ç†ä¸ç”¨æˆ·ç›¸å…³çš„ HTTP è¯·æ±‚ã€‚</p>
<p>controllers ä¸­çš„é™æ€æ–¹æ³•ä¸ä¸Šæ–‡æåˆ°çš„ modules ä¸­çš„é™æ€æ–¹æ³•ä¸€ä¸€å¯¹åº”ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> userModel = <span class="built_in">require</span>(<span class="string">&#x27;../modules/user&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">userController</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">async</span> <span class="title function_">show</span>(<span class="params">ctx</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> users = <span class="keyword">await</span> userModel.<span class="title function_">showAllUsers</span>();</span><br><span class="line">        ctx.<span class="property">response</span>.<span class="property">status</span> = <span class="number">200</span>;</span><br><span class="line">        ctx.<span class="property">body</span> = &#123;</span><br><span class="line">            <span class="attr">status</span>: <span class="number">200</span>,</span><br><span class="line">            <span class="attr">message</span>: <span class="string">&#x27;success&#x27;</span>,</span><br><span class="line">            <span class="attr">data</span>: users</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">async</span> <span class="title function_">create</span>(<span class="params">ctx</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> data = ctx.<span class="property">request</span>.<span class="property">body</span>;</span><br><span class="line">        <span class="keyword">const</span> username = data.<span class="property">username</span>;</span><br><span class="line">        <span class="keyword">const</span> password = data.<span class="property">password</span>;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(username + <span class="string">&#x27; &#x27;</span> + password);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> newUser = <span class="keyword">await</span> userModel.<span class="title function_">createUser</span>(username, password);</span><br><span class="line">        ctx.<span class="property">response</span>.<span class="property">status</span> = <span class="number">200</span>;</span><br><span class="line">        ctx.<span class="property">body</span> = &#123;</span><br><span class="line">            <span class="attr">status</span>: <span class="number">200</span>,</span><br><span class="line">            <span class="attr">message</span>: <span class="string">&#x27;success&#x27;</span>,</span><br><span class="line">            <span class="attr">data</span>: newUser</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">async</span> <span class="title function_">delete</span>(<span class="params">ctx</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> data = ctx.<span class="property">request</span>.<span class="property">body</span>;</span><br><span class="line">        <span class="keyword">const</span> username = data.<span class="property">username</span>;</span><br><span class="line">        <span class="keyword">const</span> result = <span class="keyword">await</span> userModel.<span class="title function_">deleteUser</span>(username);</span><br><span class="line">        ctx.<span class="property">response</span>.<span class="property">status</span> = <span class="number">200</span>;</span><br><span class="line">        ctx.<span class="property">body</span> = &#123;</span><br><span class="line">            <span class="attr">status</span>: <span class="number">200</span>,</span><br><span class="line">            <span class="attr">message</span>: <span class="string">&#x27;success&#x27;</span>,</span><br><span class="line">            <span class="attr">data</span>: result</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">async</span> <span class="title function_">search</span>(<span class="params">ctx</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> data = ctx.<span class="property">request</span>.<span class="property">body</span>;</span><br><span class="line">        <span class="keyword">const</span> username = data.<span class="property">username</span>;</span><br><span class="line">        <span class="keyword">const</span> result = <span class="keyword">await</span> userModel.<span class="title function_">searchUser</span>(username);</span><br><span class="line">        ctx.<span class="property">response</span>.<span class="property">status</span> = <span class="number">200</span>;</span><br><span class="line">        ctx.<span class="property">body</span> = &#123;</span><br><span class="line">            <span class="attr">status</span>: <span class="number">200</span>,</span><br><span class="line">            <span class="attr">message</span>: <span class="string">&#x27;success&#x27;</span>,</span><br><span class="line">            <span class="attr">data</span>: result</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">async</span> <span class="title function_">update</span>(<span class="params">ctx</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> data = ctx.<span class="property">request</span>.<span class="property">body</span>;</span><br><span class="line">        <span class="keyword">const</span> userId = data.<span class="property">userId</span>;</span><br><span class="line">        <span class="keyword">const</span> username = data.<span class="property">username</span>;</span><br><span class="line">        <span class="keyword">const</span> password = data.<span class="property">password</span>;</span><br><span class="line">        <span class="keyword">const</span> result = <span class="keyword">await</span> userModel.<span class="title function_">updateUser</span>(userId, username, password);</span><br><span class="line">        ctx.<span class="property">response</span>.<span class="property">status</span> = <span class="number">200</span>;</span><br><span class="line">        ctx.<span class="property">body</span> = &#123;</span><br><span class="line">            <span class="attr">status</span>: <span class="number">200</span>,</span><br><span class="line">            <span class="attr">message</span>: <span class="string">&#x27;success&#x27;</span>,</span><br><span class="line">            <span class="attr">data</span>: result</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = userController;</span><br></pre></td></tr></table></figure>

<h2 id="router-api"><a href="#router-api" class="headerlink" title="router&#x2F;api"></a>router&#x2F;api</h2><p>æˆ‘ä»¬ä¸ºæ¯ä¸ªæ¥å£å•ç‹¬åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œä¾¿äºåæœŸç»´æŠ¤ã€‚æ¯ä¸ªæ¥å£ä¹Ÿæ˜¯å¯¹åº”åˆ° <code>userControllers</code> ç±»ä¸­çš„é™æ€æ–¹æ³•ã€‚</p>
<p><code>/api/show</code> æ¥å£ï¼Œç”¨äºå±•ç¤ºå½“å‰æ•°æ®åº“æ‰€æœ‰å†…å®¹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Router</span> = <span class="built_in">require</span>(<span class="string">&#x27;koa-router&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> userController = <span class="built_in">require</span>(<span class="string">&#x27;../controllers/user&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> <span class="title class_">Router</span>();</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/api/show&#x27;</span>, userController.<span class="property">show</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br></pre></td></tr></table></figure>

<p><code>/api/create</code> æ¥å£ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„ç”¨æˆ·ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Router</span> = <span class="built_in">require</span>(<span class="string">&#x27;koa-router&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> userController = <span class="built_in">require</span>(<span class="string">&#x27;../controllers/user&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> <span class="title class_">Router</span>();</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/api/create&#x27;</span>, userController.<span class="property">create</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br></pre></td></tr></table></figure>

<p><code>/api/delete</code> æ¥å£ï¼Œç”¨äºåˆ é™¤ä¸€ä¸ªç”¨æˆ·ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Router</span> = <span class="built_in">require</span>(<span class="string">&#x27;koa-router&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> userController = <span class="built_in">require</span>(<span class="string">&#x27;../controllers/user&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> <span class="title class_">Router</span>();</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/api/delete&#x27;</span>, userController.<span class="property">delete</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br></pre></td></tr></table></figure>

<p><code>/api/search</code> æ¥å£ï¼Œç”¨äºæŸ¥æ‰¾ä¸€ä¸ªç”¨æˆ·ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Router</span> = <span class="built_in">require</span>(<span class="string">&#x27;koa-router&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> userController = <span class="built_in">require</span>(<span class="string">&#x27;../controllers/user&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> <span class="title class_">Router</span>();</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/api/search&#x27;</span>, userController.<span class="property">search</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br></pre></td></tr></table></figure>

<p><code>/api/update</code> æ¥å£ï¼Œç”¨äºæ›´æ–°ä¸€ä¸ªç”¨æˆ·çš„ä¿¡æ¯ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Router</span> = <span class="built_in">require</span>(<span class="string">&#x27;koa-router&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> userController = <span class="built_in">require</span>(<span class="string">&#x27;../controllers/user&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> <span class="title class_">Router</span>();</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/api/update&#x27;</span>, userController.<span class="property">update</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br></pre></td></tr></table></figure>

<h2 id="bodyparser-cors"><a href="#bodyparser-cors" class="headerlink" title="bodyparser &amp; cors"></a>bodyparser &amp; cors</h2><h3 id="å‚æ•°è§£æ"><a href="#å‚æ•°è§£æ" class="headerlink" title="å‚æ•°è§£æ"></a>å‚æ•°è§£æ</h3><p>åŸç”Ÿ kao ä¸æ”¯æŒè§£æ POST è¯·æ±‚æ­£æ–‡æ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ­¤æ—¶ä½ ç¼–å†™çš„ body å‚æ•°è§£æä»£ç å¹¶ä¸ç”Ÿæ•ˆï¼</p>
<p>å°±åƒæˆ‘ä»¬ç¼–å†™çš„ controllers éƒ¨åˆ†ä»£ç éœ€è¦è§£æ POST è¯·æ±‚ä¸»ä½“å¹¶è·å–å‚æ•°ï¼Œæ­¤æ—¶å¹¶ä¸ä¼šç”Ÿæ•ˆã€‚æ¯”å¦‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// /controllers/user.js</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">userController</span> &#123;</span><br><span class="line"> 	... ...</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">async</span> <span class="title function_">create</span>(<span class="params">ctx</span>) &#123;</span><br><span class="line">        <span class="comment">// è§£æ POST è¯·æ±‚ä¸»ä½“ä¸­çš„ username &amp; password å‚æ•°</span></span><br><span class="line">        <span class="keyword">const</span> data = ctx.<span class="property">request</span>.<span class="property">body</span>;</span><br><span class="line">        <span class="keyword">const</span> username = data.<span class="property">username</span>;</span><br><span class="line">        <span class="keyword">const</span> password = data.<span class="property">password</span>;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ... ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…ä»¥ä¸‹ä¾èµ–åº“ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add -D koa-bodyparser</span><br></pre></td></tr></table></figure>

<p><code>koa-bodyparser</code> æ˜¯ä¸€ä¸ª koa æ¡†æ¶çš„ä¸­é—´ä»¶ï¼Œå®ƒå¯ä»¥è§£æ HTTP è¯·æ±‚çš„æ­£æ–‡ï¼ˆbodyï¼‰æ•°æ®ï¼Œå¹¶å°†è§£æåçš„æ•°æ®å­˜å‚¨åœ¨ <code>ctx.request.body</code> ä¸­ã€‚å®ƒæ”¯æŒè§£æ JSONã€è¡¨å•å’Œæ–‡æœ¬ç±»å‹çš„æ­£æ–‡æ•°æ®ï¼Œä½†ä¸æ”¯æŒè§£æå¤šéƒ¨åˆ†æ ¼å¼ï¼ˆmultipartï¼‰æ•°æ®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæƒ³è¦å®ç°æ–‡ä»¶ä¸Šä¼ ï¼Œæˆ‘ä»¬è¿˜ä¼šéœ€è¦å…¶ä»–çš„åº“ã€‚</p>
<p>å®‰è£…æˆåŠŸåï¼Œæˆ‘ä»¬å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ° app.js ä¸­ï¼Œä¹‹åæˆ‘ä»¬ç”¨äºè§£æ body çš„ä»£ç å°±èƒ½å¤Ÿæ­£å¸¸å·¥ä½œäº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;koa-bodyparser&#x27;</span>);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">bodyParser</span>());</span><br></pre></td></tr></table></figure>

<h3 id="è·¨åŸŸ"><a href="#è·¨åŸŸ" class="headerlink" title="è·¨åŸŸ"></a>è·¨åŸŸ</h3><p>å‡è®¾ä½ çš„ koa åç«¯è¿è¡Œåœ¨ <a target="_blank" rel="noopener" href="http://localhost:3000/">http://localhost:3000</a>ï¼Œè€Œä½ çš„ react å‰ç«¯è¿è¡Œåœ¨ <a target="_blank" rel="noopener" href="http://localhost:5173/">http://localhost:5173</a>ã€‚å¦‚æœæ­¤æ—¶ä½ çš„å‰ç«¯æœåŠ¡å‘åç«¯ api å‘é€è¯·æ±‚ï¼Œä¼šé­åˆ°æ‹’ç»ï¼Œæç¤ºå­˜åœ¨è·¨åŸŸé—®é¢˜ï¼š</p>
<div align='center'>
    <img src='https://agu-images.oss-cn-hangzhou.aliyuncs.com/test/image-20230829135418397.png' />
</div>

<p>æœ€ç®€å•çš„è§£å†³æ–¹æ³•å°±æ˜¯åœ¨æˆ‘ä»¬çš„ app.js ä¸­æ·»åŠ ä¸€ä¸ªç”¨äºå¤„ç†è·¨åŸŸèµ„æºå…±äº«ï¼ˆCORSï¼‰çš„ä¸­é—´ä»¶ï¼Œä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æŒ‡ä»¤å®‰è£…è¿™ä¸ªåº“ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add -D koa-cors</span><br></pre></td></tr></table></figure>

<p>å®‰è£…æˆåŠŸåï¼Œå°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ° app.js ä¸­ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> cors = <span class="built_in">require</span>(<span class="string">&#x27;koa-cors&#x27;</span>);</span><br><span class="line">...</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cors</span>());</span><br></pre></td></tr></table></figure>

<h2 id="app"><a href="#app" class="headerlink" title="app"></a>app</h2><p>åœ¨è§£å†³å‰é¢çš„å·¥ä½œä¹‹åï¼Œæˆ‘ä»¬å¼€å§‹ç¼–å†™å…¥å£æ–‡ä»¶ app.jsï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Koa</span> = <span class="built_in">require</span>(<span class="string">&#x27;koa&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;koa-bodyparser&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> cors = <span class="built_in">require</span>(<span class="string">&#x27;koa-cors&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">InitManager</span> = <span class="built_in">require</span>(<span class="string">&#x27;./core/init&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> <span class="title class_">Koa</span>();</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cors</span>());</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">bodyParser</span>());</span><br><span class="line"><span class="title class_">InitManager</span>.<span class="title function_">initCore</span>(app);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3000</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`ğŸ Listening on localhost:3000 ...`</span>);</span><br></pre></td></tr></table></figure>

<p>å®Œæˆä¹‹åï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹è¿è¡Œ <code>node app.js</code> æŒ‡ä»¤ï¼Œå³å¯å¯åŠ¨æˆ‘ä»¬çš„ koa åç«¯æœåŠ¡ï¼</p>
<h2 id="æµ‹è¯•å·¥å…·"><a href="#æµ‹è¯•å·¥å…·" class="headerlink" title="æµ‹è¯•å·¥å…·"></a>æµ‹è¯•å·¥å…·</h2><p>æˆ‘ä»¬æŒ‰ç…§ä»¥ä¸Šæ­¥éª¤å®ç°äº†ä¸€å¥— koa-crudï¼Œè¿˜éœ€è¦å¯¹å…¶åŠŸèƒ½è¿›è¡Œæµ‹è¯•ğŸ¤§ã€‚</p>
<p>å½“ç„¶ï¼Œä½ å¯ä»¥é€šè¿‡è®¿é—®ç½‘é¡µå®Œæˆå¯¹ api çš„æµ‹è¯•ï¼Œä½†è¿™ç§æ–¹æ³•å±€é™æ€§å¤ªå¤§ï¼Œä¸å¤Ÿçµæ´»ä¸”å¾ˆä¸æ–¹ä¾¿ã€‚å¥½åœ¨ï¼Œç°åœ¨æœ‰å¾ˆå¤šæˆç†Ÿçš„ğŸ”¨å·¥å…·ä¾›æˆ‘ä»¬ä½¿ç”¨ã€‚</p>
<p>æˆ‘ä¸ªäººæ¨è <code>postman</code>ã€‚</p>
<p>postman æ˜¯ä¸€æ¬¾ç”¨äºæµ‹è¯•å’Œå¼€å‘ API çš„åˆä½œå¹³å°å’Œå·¥å…·ã€‚å®ƒæä¾›äº†ä¸€ä¸ªç”¨æˆ·å‹å¥½çš„ç•Œé¢ï¼Œè®©å¼€å‘äººå‘˜èƒ½å¤Ÿè½»æ¾åœ°å‘é€ HTTP è¯·æ±‚ã€æµ‹è¯•å“åº”å¹¶ä¸ API è¿›è¡Œäº¤äº’</p>
<p>ä½¿ç”¨ postmanï¼Œä½ å¯ä»¥åˆ›å»ºå„ç§ç±»å‹çš„ HTTP è¯·æ±‚ï¼ˆä¾‹å¦‚ GETã€POST å’Œ PUTï¼‰ï¼Œè®¾ç½®è¯·æ±‚å‚æ•°ï¼ˆå¦‚å¤´éƒ¨ã€èº«ä½“ã€æŸ¥è¯¢å‚æ•°ç­‰ï¼‰ï¼Œå‘é€è¯·æ±‚ï¼Œå¹¶æŸ¥çœ‹æœåŠ¡å™¨è¿”å›çš„å“åº”ã€‚å®ƒè¿˜æä¾›äº†æ–­è¨€ï¼ˆassertionsï¼‰åŠŸèƒ½ï¼Œç”¨äºéªŒè¯APIçš„å“åº”æ˜¯å¦ç¬¦åˆé¢„æœŸã€‚</p>
<div align='center'>
    <img src='https://agu-images.oss-cn-hangzhou.aliyuncs.com/test/image-20230829141158347.png' />
</div>

<p>ä¸‹è½½ä½¿ç”¨éƒ½å¾ˆç®€å•ï¼Œè¿™é‡Œä¸åšä»‹ç»ï¼Œè¯·è‡ªè¡Œå‰å¾€ ğŸ’¥<a target="_blank" rel="noopener" href="https://www.postman.com/">postman å®˜ç½‘</a> äº†è§£ã€‚</p>
<h2 id="ä¼˜åŒ–"><a href="#ä¼˜åŒ–" class="headerlink" title="ä¼˜åŒ–"></a>ä¼˜åŒ–</h2><p>ä»¥ä¸Šä»£ç å°±æ˜¯ <code>kao+sqlite</code> å®ç° CRUD çš„ç®€å•å®æˆ˜ï¼Œæ•´å¥—ä»£ç è¿˜æœ‰å¾ˆå¤šå¯ä»¥âœ¨ä¼˜åŒ–çš„åœ°æ–¹ã€‚</p>
<p>æ¯”å¦‚ï¼Œè°ƒç”¨è¿™ä¸ª koa æœåŠ¡ä¸­çš„ api éƒ½éœ€è¦ä½¿ç”¨ POST è¯·æ±‚ï¼Œä¸ç¬¦åˆç›®å‰æµè¡Œçš„ <code>RESTful</code> è®¾è®¡é£æ ¼ï¼Œåç»­å¯ä»¥è¿›è¡Œè°ƒæ•´ï¼ˆä½† POST ä¸€æŠŠå—¦ç¡®å®æ— è„‘æ˜“ç”¨ğŸ¤£ï¼‰ã€‚</p>
<p>åœ¨ controllers ä¸­ï¼Œæˆ‘ä¹Ÿæ²¡æœ‰è¿›è¡Œé€‚å½“çš„é”™è¯¯å¤„ç†ï¼Œä¸æ–¹ä¾¿ DEBUGï¼Œä¹Ÿæ˜¯å¯ä»¥ä¼˜åŒ–çš„ç‚¹ã€‚</p>
<p>å¯¹ä¼ å…¥å‚æ•°çš„å¤„ç†ä¹Ÿæ²¡æœ‰åšï¼Œæˆ‘ä¸æ™“å¾— koa-bodyparser æœ‰æ²¡æœ‰è¿›è¡Œå¤„ç†ï¼Œä¹Ÿå¯èƒ½ä¼šå­˜åœ¨å®‰å…¨é—®é¢˜ã€‚</p>
<blockquote>
<p>é—®é¢˜å¤šå¤šâ¤ï½æ‘©å¤šæ‘©å¤šâ¤ï½</p>
</blockquote>
<p>ä¸è¿‡å‘¢ï¼Œè¿™æ˜¯é˜¿è‡ç¬¬ä¸€æ¬¡ç”¨ koa å†™åç«¯æœåŠ¡ï¼ˆå…¶å®åç«¯éƒ½æ²¡æ€ä¹ˆå†™è¿‡ğŸ¥²ï¼‰ï¼Œè‡³å°‘èƒ½è·‘èµ·æ¥äº†ï¼åç»­ä¼šç»§ç»­ä¼˜åŒ–è¿™ä¸ªæœåŠ¡ï¼Œå¹¶æ›´æ–°åœ¨ GitHub ä»“åº“ä¸­ï¼Œä»¥ä¸Šå®ç°çš„ api ä¼šè¢«è§„èŒƒåŒ–ä¸º <code>/api/v1/*</code>ï¼Œä¹‹åä¼˜åŒ–è¿‡çš„ç‰ˆæœ¬ä¼šæ³¨å†Œä¸º <code>/api/v2/</code>ï¼Œè¿™æ ·åšå¯èƒ½è¾ƒç¬¦åˆå®é™…ç”Ÿäº§ç¯å¢ƒçš„å†™æ³•â€¦â€¦</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.koajs.com.cn/#">Koa ä¸­æ–‡ç½‘</a></li>
<li><a target="_blank" rel="noopener" href="https://chenshenhai.github.io/koa2-note/">Koa2 è¿›é˜¶å­¦ä¹ ç¬”è®°</a></li>
<li><a target="_blank" rel="noopener" href="https://www.liaoxuefeng.com/wiki/1022910821149312/1023025933764960">koa - å»–é›ªå³°çš„å®˜æ–¹ç½‘ç«™</a></li>
<li><a target="_blank" rel="noopener" href="https://ruanyifeng.com/blog/2017/08/koa.html">Koa æ¡†æ¶æ•™ç¨‹ - é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—</a></li>
<li><a target="_blank" rel="noopener" href="https://juejin.cn/post/7066568536944017438#heading-8">koa è¿æ¥sqlite3 é¡¹ç›®ç›®å½•ç»“æ„ - ç¨€åœŸæ˜é‡‘</a></li>
</ul>
<h2 id="åè¯"><a href="#åè¯" class="headerlink" title="åè¯"></a>åè¯</h2><p>æ¯æ¬¡å†™CRUDï¼Œéƒ½ä¼šè§‰å¾—åç«¯è¿™å¥—ä¸œè¥¿çš„é€»è¾‘æ€§æ¯”å‰ç«¯è¦å¼ºğŸ˜‡ï¼Œå†™çš„æ—¶å€™è¡Œäº‘æµæ°´ã€‚</p>
<p><code>koa</code> ç»™æˆ‘çš„å¼€å‘åˆä½“éªŒä¸é”™ï¼Œä¸»æ‰“ä¸€ä¸ªè½»ä¾¿ç®€æ´ï¼Œä»…å­˜å‚¨å°‘é‡æ•°æ®æ—¶é…åˆ <code>sqlite</code> æ›´æ˜¯æ–¹ä¾¿ã€‚</p>

  </div>
</article>


    <div class="blog-post-comments">
        <div id="utterances_thread">
            <noscript>åŠ è½½è¯„è®ºéœ€è¦åœ¨æµè§ˆå™¨å¯ç”¨ JavaScript è„šæœ¬æ”¯æŒã€‚</noscript>
        </div>
    </div>


        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">é¦–é¡µ</a></li>
        
          <li><a href="/about/">å…³äº</a></li>
        
          <li><a href="/archives/">å½’æ¡£</a></li>
        
          <li><a href="/friends/">å‹é“¾</a></li>
        
          <li><a href="/categories/">åˆ†ç±»</a></li>
        
          <li><a target="_blank" rel="noopener" href="http://github.com/ma5hr00m">é¡¹ç›®</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%86%E5%A4%87"><span class="toc-number">1.</span> <span class="toc-text">å‡†å¤‡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#koa"><span class="toc-number">1.1.</span> <span class="toc-text">koa</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sqlite"><span class="toc-number">1.2.</span> <span class="toc-text">sqlite</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F"><span class="toc-number">2.</span> <span class="toc-text">æ¨¡å¼</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E6%88%98%E5%9C%BA%E6%99%AF%E6%A6%82%E6%8B%AC"><span class="toc-number">3.</span> <span class="toc-text">å®æˆ˜åœºæ™¯æ¦‚æ‹¬</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E9%A1%B9%E7%9B%AE"><span class="toc-number">4.</span> <span class="toc-text">åˆå§‹åŒ–é¡¹ç›®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#init-ping"><span class="toc-number">5.</span> <span class="toc-text">init &amp; ping</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#database"><span class="toc-number">6.</span> <span class="toc-text">database</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#schema"><span class="toc-number">7.</span> <span class="toc-text">schema</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#modules"><span class="toc-number">8.</span> <span class="toc-text">modules</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#controllers"><span class="toc-number">9.</span> <span class="toc-text">controllers</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#router-api"><span class="toc-number">10.</span> <span class="toc-text">router&#x2F;api</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bodyparser-cors"><span class="toc-number">11.</span> <span class="toc-text">bodyparser &amp; cors</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E8%A7%A3%E6%9E%90"><span class="toc-number">11.1.</span> <span class="toc-text">å‚æ•°è§£æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%A8%E5%9F%9F"><span class="toc-number">11.2.</span> <span class="toc-text">è·¨åŸŸ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#app"><span class="toc-number">12.</span> <span class="toc-text">app</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7"><span class="toc-number">13.</span> <span class="toc-text">æµ‹è¯•å·¥å…·</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%98%E5%8C%96"><span class="toc-number">14.</span> <span class="toc-text">ä¼˜åŒ–</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">15.</span> <span class="toc-text">å‚è€ƒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%8E%E8%AF%9D"><span class="toc-number">16.</span> <span class="toc-text">åè¯</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://blog.ma5hr00m.top/2023/04/28/202304/koa2-crud-example/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://blog.ma5hr00m.top/2023/04/28/202304/koa2-crud-example/&text=åŸºäº Koa2+SQLite æ„å»º CRUD API"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://blog.ma5hr00m.top/2023/04/28/202304/koa2-crud-example/&title=åŸºäº Koa2+SQLite æ„å»º CRUD API"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://blog.ma5hr00m.top/2023/04/28/202304/koa2-crud-example/&is_video=false&description=åŸºäº Koa2+SQLite æ„å»º CRUD API"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=åŸºäº Koa2+SQLite æ„å»º CRUD API&body=Check out this article: https://blog.ma5hr00m.top/2023/04/28/202304/koa2-crud-example/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://blog.ma5hr00m.top/2023/04/28/202304/koa2-crud-example/&title=åŸºäº Koa2+SQLite æ„å»º CRUD API"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://blog.ma5hr00m.top/2023/04/28/202304/koa2-crud-example/&title=åŸºäº Koa2+SQLite æ„å»º CRUD API"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://blog.ma5hr00m.top/2023/04/28/202304/koa2-crud-example/&title=åŸºäº Koa2+SQLite æ„å»º CRUD API"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://blog.ma5hr00m.top/2023/04/28/202304/koa2-crud-example/&title=åŸºäº Koa2+SQLite æ„å»º CRUD API"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://blog.ma5hr00m.top/2023/04/28/202304/koa2-crud-example/&name=åŸºäº Koa2+SQLite æ„å»º CRUD API&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://blog.ma5hr00m.top/2023/04/28/202304/koa2-crud-example/&t=åŸºäº Koa2+SQLite æ„å»º CRUD API"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> èœå•</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> ç›®å½•</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> åˆ†äº«</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> è¿”å›é¡¶éƒ¨</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2022-2024
    ma5hr00m
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">é¦–é¡µ</a></li><!--
     --><!--
       --><li><a href="/about/">å…³äº</a></li><!--
     --><!--
       --><li><a href="/archives/">å½’æ¡£</a></li><!--
     --><!--
       --><li><a href="/friends/">å‹é“¾</a></li><!--
     --><!--
       --><li><a href="/categories/">åˆ†ç±»</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/ma5hr00m">é¡¹ç›®</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"å¤åˆ¶åˆ°ç²˜è´´æ¿ï¼\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "å¤åˆ¶æˆåŠŸï¼");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

  <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?8a3de63e395686941d3b2d65a69ac600";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
        </script>

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

    <script type="text/javascript">
      var utterances_repo = 'ma5hr00m/ma5hr00m.github.io';
      var utterances_issue_term = 'pathname';
      var utterances_label = 'Comment';
      var utterances_theme = 'github-dark';

      (function(){
          var script = document.createElement('script');

          script.src = 'https://utteranc.es/client.js';
          script.setAttribute('repo', utterances_repo);
          script.setAttribute('issue-term', 'pathname');
          script.setAttribute('label', utterances_label);
          script.setAttribute('theme', utterances_theme);
          script.setAttribute('crossorigin', 'anonymous');
          script.async = true;
          (document.getElementById('utterances_thread')).appendChild(script);
      }());
  </script>

</body>
</html>
